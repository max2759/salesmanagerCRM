<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:fxs="http://java.sun.com/jsf/composite/composantsFxs"
                template="WEB-INF/templates/template.xhtml">

    <ui:define name="title">#{bundle['company.title']}</ui:define>
    <ui:define name="content">

        <f:metadata>
            <f:viewAction action="#{companiesBean.displayCompanyDetails}"/>
            <f:viewAction action="#{notesBean.setParamType('displayByCompany')}"/>
            <f:viewAction action="#{tasksBean.setParamType('displayByCompany')}"/>
            <f:viewAction action="#{tasksBean.createNewEntity}"/>
            <f:viewAction action="#{tasksBean.listEntitiesCompanies}"/>
            <f:viewAction action="#{taskTypesBean.findAllTaskTypesEntities}"/>
            <f:viewAction action="#{notesBean.createNewEntity}"/>
            <f:viewAction action="#{notesBean.listEntitiesCompanies}"/>
            <f:viewAction action="#{companiesBean.activityThread}"/>
        </f:metadata>

        <p:growl id="msgs" skipDetailIfEqualsSummary="true" life="10000"/>

        <div class="ui-g">
            <div class="ui-g-12 ui-md-6 ui-lg-4">
                <div class="card card-w-title">
                    <h1>#{bundle['company.details']}</h1>
                    <h:form id="companyDetailsUpdateForm">
                        <p:panelGrid columns="4" layout="flex"
                                     id="companyDetailsUpdatePanelGrid"
                                     columnClasses="p-col-12 p-md-3 p-xl-2, p-col-12 p-md-9 p-xl-4, p-col-12 p-md-3 p-xl-2, p-col-12 p-md-9 p-xl-4"
                                     contentStyleClass="ui-fluid" styleClass="ui-panelgrid-blank form-group">

                            <p:accordionPanel multiple="true">
                                <p:tab title="#{bundle['company.tabTitle1']}">
                                    <h:panelGroup styleClass="md-inputfield"
                                                  style="margin-top:15px; margin-bottom: 30px">
                                        <p:inputText id="domainName"
                                                     value="#{companiesBean.companiesEntity.domainName}">
                                            <f:validator validatorId="companyDomainValidator"/>
                                        </p:inputText>
                                        <label>#{bundle['company.domainName']}</label>
                                    </h:panelGroup>

                                    <h:panelGroup styleClass="md-inputfield" style=" margin-bottom:10px;">
                                        <p:inputText id="labelCompany" value="#{companiesBean.companiesEntity.label}"
                                                     required="true"
                                                     requiredMessage="#{bundle['company.labelNotValid']}"/>
                                        <label>#{bundle['company.labelName']}</label>
                                        <p:ajax event="keyup" update="@form:companyDetailsValidateBtn"/>
                                    </h:panelGroup>

                                    <h:panelGroup styleClass="md-inputfield"
                                                  style="margin-top:30px; margin-bottom:10px;">
                                        <p:inputTextarea id="companyDescription"
                                                         value="#{companiesBean.companiesEntity.description}"/>
                                        <label>#{bundle['company.description']}</label>
                                    </h:panelGroup>

                                    <h:panelGroup styleClass="md-inputfield"
                                                  style="margin-top:30px; margin-bottom:10px;">
                                        <p:autoComplete id="branchActivitiesDisplay" dropdown="true"
                                                        value="#{companiesBean.companiesEntity.branchActivitiesByIdBranchActivities}"
                                                        completeMethod="#{branchActivitiesBean.completeBranchActivities}"
                                                        var="branchActivities"
                                                        itemLabel="#{branchActivities.label}"
                                                        itemValue="#{branchActivities}"
                                                        converter="branchActivitiesConverter"
                                                        scrollHeight="250"
                                                        groupBy="#{branchActivitiesBean.getBranchActivitiesEntityGroup(branchActivities)}"
                                                        placeholder="#{bundle['company.chooseBranchActivity']}"/>
                                    </h:panelGroup>

                                    <h:panelGroup styleClass="md-inputfield"
                                                  style="margin-top:30px; margin-bottom:10px;">
                                        <p:autoComplete id="companyTypesDisplay" dropdown="true"
                                                        value="#{companiesBean.companiesEntity.companyTypesByIdCompanyTypes}"
                                                        required="true"
                                                        requiredMessage="#{bundle['company.companiesTypeNotValid']}"
                                                        completeMethod="#{companyTypesBean.completeCompanyTypes}"
                                                        var="companyTypes"
                                                        itemLabel="#{companyTypes.label}"
                                                        itemValue="#{companyTypes}"
                                                        converter="companyTypesConverter"
                                                        scrollHeight="250"
                                                        groupBy="#{companyTypesBean.getCompanyTypesEntityGroup(companyTypes)}"
                                                        placeholder="#{bundle['company.chooseCompanyType']}"/>
                                    </h:panelGroup>

                                    <h:panelGroup styleClass="md-inputfield"
                                                  style="margin-top:30px; margin-bottom:10px;">
                                        <p:inputNumber id="employeesNumber"
                                                       value="#{companiesBean.companiesEntity.employeesNumber}"
                                                       validatorMessage="#{bundle['company.employeesNumberNotValid']}">
                                            <f:validateLongRange minimum="0"/>
                                        </p:inputNumber>
                                        <label>#{bundle['company.employessNumber']}</label>
                                    </h:panelGroup>

                                    <h:panelGroup styleClass="md-inputfield"
                                                  style="margin-top:30px; margin-bottom:10px;">
                                        <p:inputNumber id="revenue" value="#{companiesBean.companiesEntity.revenue}"
                                                       validatorMessage="#{bundle['company.employeesNumberNotValid']}">
                                            <f:validateLongRange minimum="0"/>
                                        </p:inputNumber>
                                        <label>#{bundle['company.revenue']}</label>
                                    </h:panelGroup>

                                    <h:panelGroup styleClass="md-inputfield"
                                                  style="margin-top:30px; margin-bottom:10px;">
                                        <p:inputNumber id="companyAnnualSales"
                                                       value="#{companiesBean.companiesEntity.annualSales}"
                                                       validatorMessage="#{bundle['company.employeesNumberNotValid']}">
                                            <f:validateLongRange minimum="0"/>
                                        </p:inputNumber>
                                        <label>#{bundle['company.annualSales']}</label>
                                    </h:panelGroup>

                                    <h:panelGroup styleClass="md-inputfield"
                                                  style="margin-top:30px;margin-bottom:10px;">
                                        <p:inputMask id="companyCreationDate"
                                                     value="#{companiesBean.companiesEntity.creationDate}"
                                                     mask="9999"
                                        >
                                            <f:validator validatorId="companyDateValidator"/>
                                        </p:inputMask>
                                        <label>#{bundle['company.creationDate']}</label>
                                    </h:panelGroup>

                                    <h:panelGroup styleClass="md-inputfield"
                                                  style="margin-top:30px; margin-bottom:10px;">
                                        <p:inputMask id="companyClosingDate"
                                                     value="#{companiesBean.companiesEntity.closingDate}"
                                                     mask="9999"
                                        >
                                            <f:validator validatorId="companyClosingDateValidator"/>
                                        </p:inputMask>
                                        <label>#{bundle['company.closingDate']}</label>
                                    </h:panelGroup>

                                </p:tab>

                                <p:tab title="#{bundle['company.tabTitle2']}">

                                    <h:panelGroup styleClass="md-inputfield"
                                                  style="margin-top:30px; margin-bottom:10px;">
                                        <p:inputText id="companyAddressStreet"
                                                     value="#{addressesBean.addressesEntity.street}">
                                        </p:inputText>
                                        <label>#{bundle['address.street']}</label>
                                    </h:panelGroup>

                                    <h:panelGroup styleClass="md-inputfield"
                                                  style="margin-top:30px; margin-bottom:10px;">
                                        <p:inputText id="companyNumberAdress"
                                                     required="#{not empty addressesBean.addressesEntity.street}"
                                                     value="#{addressesBean.addressesEntity.number}">
                                        </p:inputText>
                                        <label>#{bundle['address.number']}</label>
                                    </h:panelGroup>

                                    <h:panelGroup styleClass="md-inputfield"
                                                  style="margin-top:30px; margin-bottom:10px;">
                                        <p:inputText id="companyBox"
                                                     value="#{addressesBean.addressesEntity.box}">
                                        </p:inputText>
                                        <label>#{bundle['address.box']}</label>
                                    </h:panelGroup>

                                    <h:panelGroup styleClass="md-inputfield"
                                                  style="margin-top:30px; margin-bottom:10px;">
                                        <p:autoComplete id="addressCity" dropdown="true"
                                                        value="#{addressesBean.addressesEntity.citiesByIdCities}"
                                                        completeMethod="#{citiesBean.completeCitiesEntityContains}"
                                                        var="cities"
                                                        itemLabel="#{cities.label}"
                                                        itemValue="#{cities}"
                                                        scrollHeight="250"
                                                        converter="citiesConverter"
                                                        groupBy="#{citiesBean.getCitiesEntityGroup(cities)}"
                                                        placeholder="#{bundle['cities.chooseCity']}"/>
                                    </h:panelGroup>

                                    <h:panelGroup styleClass="md-inputfield"
                                                  style="margin-top:30px; margin-bottom:10px;">
                                        <span style="margin-right: 15px"
                                              class="labelLike">#{bundle['address.region']}</span>
                                        <h:outputText id="addressRegion"
                                                      value="#{addressesBean.addressesEntity.citiesByIdCities.region eq null ? '--' : addressesBean.addressesEntity.citiesByIdCities.region}">
                                        </h:outputText>
                                    </h:panelGroup>

                                    <h:panelGroup styleClass="md-inputfield"
                                                  style="margin-top:30px; margin-bottom:10px;">
                                        <span style="margin-right: 15px"
                                              class="labelLike">#{bundle['address.postalCode']}</span>
                                        <h:outputText id="addressPostalCode"
                                                      value="#{addressesBean.addressesEntity.citiesByIdCities.postalCode eq null ? '--' : addressesBean.addressesEntity.citiesByIdCities.postalCode}">
                                        </h:outputText>
                                    </h:panelGroup>

                                    <h:panelGroup styleClass="md-inputfield"
                                                  style="margin-top:30px; margin-bottom:10px;">
                                        <span style="margin-right: 15px"
                                              class="labelLike">#{bundle['address.country']}</span>
                                        <h:outputText id="addressCountry"
                                                      value="#{addressesBean.addressesEntity.citiesByIdCities.countriesByIdCountries.label eq null ? '--' : addressesBean.addressesEntity.citiesByIdCities.countriesByIdCountries.label}">
                                        </h:outputText>
                                    </h:panelGroup>

                                    <h:panelGroup styleClass="md-inputfield"
                                                  style="margin-top:30px; margin-bottom:10px;">
                                        <p:inputMask id="companyPhoneNumber"
                                                     value="#{companiesBean.companiesEntity.phoneNumber}"
                                                     mask="+32 99999999">
                                            <f:validator validatorId="contactPhoneNumberValidator"/>
                                        </p:inputMask>
                                        <label>#{bundle['contacts.phoneNumberLabel']}</label>
                                    </h:panelGroup>

                                    <h:panelGroup styleClass="md-inputfield"
                                                  style="margin-top:30px; margin-bottom:10px;">
                                        <p:inputText id="companyEmail" value="#{companiesBean.companiesEntity.email}">
                                            <f:validator validatorId="companyEmailValidator"/>
                                        </p:inputText>
                                        <label>#{bundle['contacts.emailLabel']}</label>
                                    </h:panelGroup>

                                    <h:panelGroup styleClass="md-inputfield"
                                                  style="margin-top:30px; margin-bottom:10px;">
                                        <p:inputMask id="companyVAT" value="#{companiesBean.companiesEntity.vatNumber}"
                                                     mask="BE-9999999999">
                                            <f:validator validatorId="companyVATValidator"/>
                                        </p:inputMask>
                                        <label>#{bundle['company.vatNumber']}</label>
                                    </h:panelGroup>

                                    <h:panelGroup styleClass="md-inputfield"
                                                  style="margin-top:30px; margin-bottom:10px;">
                                        <p:inputMask id="companyBankAccount"
                                                     value="#{companiesBean.companiesEntity.bankAccount}"
                                                     mask="BE-99999999999999">
                                            <f:validator validatorId="companyBankAccountValidator"/>
                                        </p:inputMask>
                                        <label>#{bundle['company.bankAccount']}</label>
                                    </h:panelGroup>
                                </p:tab>

                                <p:tab title="#{bundle['company.tabTitle3']}">

                                    <h:panelGroup styleClass="md-inputfield"
                                                  style="margin-top:30px; margin-bottom:10px;">
                                        <p:inputText id="linkedinPage"
                                                     value="#{companiesBean.companiesEntity.linkedInPage}">
                                            <f:validator validatorId="linkedinPageValidator"/>
                                        </p:inputText>
                                        <label>#{bundle['company.linkedInPage']}</label>
                                    </h:panelGroup>

                                    <h:panelGroup styleClass="md-inputfield"
                                                  style="margin-top:30px; margin-bottom:10px;">
                                        <span style="margin-right: 15px"
                                              class="labelLike">#{bundle['company.registerDateLabel']}</span>
                                        <h:outputText id="registerDate"
                                                      value="#{companiesBean.companiesEntity.registerDate eq null ? '--' : companiesBean.companiesEntity.registerDate}">
                                            <f:convertDateTime type="localDate"
                                                               pattern="dd/MM/yyyy ' #{bundle['at']} ' HH:mm"/>
                                        </h:outputText>
                                    </h:panelGroup>

                                    <h:panelGroup styleClass="md-inputfield"
                                                  style="margin-top:30px; margin-bottom:10px;">
                                        <span style="margin-right: 15px"
                                              class="labelLike">#{bundle['company.modificationDateLabel']}</span>
                                        <h:outputText id="modficationDate"
                                                      value="#{companiesBean.companiesEntity.modificationDate eq null ? '--' : companiesBean.companiesEntity.modificationDate}">
                                            <f:convertDateTime type="localDate"
                                                               pattern="dd/MM/yyyy ' #{bundle['at']} ' HH:mm"/>
                                        </h:outputText>
                                    </h:panelGroup>
                                </p:tab>
                            </p:accordionPanel>

                        </p:panelGrid>

                        <div align="right">
                            <p:commandButton value="#{bundle['validate']}"
                                             action="#{companiesBean.updateCompanies}"
                                             id="companyDetailsValidateBtn"
                                             disabled="#{empty companiesBean.companiesEntity.label}"
                                             icon="ui-icon-check"
                                             update="companyDetailsUpdateForm:companyDetailsUpdatePanelGrid msgs"
                            />
                        </div>
                    </h:form>
                </div>
            </div>

            <div class="ui-g-12 ui-md-6 ui-lg-8">
                <fxs:companyDetailsRight id="detailsRight"/>
            </div>
        </div>
    </ui:define>
</ui:composition>
